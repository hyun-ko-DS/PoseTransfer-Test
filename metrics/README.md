# 이미지 생성 평가 메트릭 가이드

## 1. LPIPS (Learned Perceptual Image Patch Similarity)

### 원리
- **딥러닝 기반 퍼셉셔널 유사도**: VGG나 AlexNet 같은 사전 학습된 CNN을 사용하여 두 이미지의 고수준 특징을 추출하고 비교
- **인간 시각과 유사한 평가**: 픽셀 단위 차이가 아닌, 인간이 인지하는 시각적 차이를 측정
- **저수준 특징 공간에서 비교**: 네트워크의 중간 레이어 특징 맵을 사용하여 유사도 계산

### 장점
- 인간의 시각적 인지와 높은 상관관계
- 픽셀 단위 차이보다 의미 있는 평가
- 이미지 품질 평가에 널리 사용됨

### 단점
- 계산 비용이 높음 (딥러닝 모델 추론 필요)
- 사전 학습된 모델에 의존

### 우리 태스크 적합성
✅ **적합**: 원본 이미지와 생성 이미지 간의 전반적인 시각적 유사성을 평가하는 데 적합
- 포즈는 다르지만 얼굴, 옷, 배경 등이 얼마나 유사한지 측정 가능

---

## 2. CLIP Image Similarity

### 원리
- **멀티모달 임베딩**: CLIP 모델이 이미지와 텍스트를 동일한 임베딩 공간에 매핑
- **코사인 유사도**: 두 이미지의 CLIP 임베딩 벡터 간 코사인 유사도 계산
- **의미적 유사성**: 고수준 의미적 특징을 비교

### 장점
- 텍스트-이미지 일치도 평가 가능
- 의미적 유사성 측정에 강함
- 계산이 상대적으로 빠름

### 단점
- 세밀한 픽셀 레벨 차이는 포착하지 못함
- 포즈 같은 구조적 정보는 직접적으로 평가하지 않음

### 우리 태스크 적합성
✅ **보조적으로 유용**: 전반적인 의미적 유사성 평가
- 원본과 생성 이미지가 같은 사람/객체를 나타내는지 확인
- 포즈 전이 후에도 얼굴, 옷 등이 유지되는지 평가

---

## 3. TIFA (Text-to-Image Faithfulness Assessment)

### 원리
- **VQA 기반 평가**: Visual Question Answering 모델을 사용하여 텍스트 프롬프트의 요소들이 이미지에 반영되었는지 질문-답변으로 평가
- **구성 요소 검증**: 프롬프트의 각 구성 요소(객체, 속성, 관계 등)가 이미지에 존재하는지 확인
- **정량적 점수**: 각 질문에 대한 정확도로 전체 점수 계산

### 장점
- 프롬프트 반영도를 정량적으로 측정
- 자동화된 평가 가능
- 세부 요소별 평가 가능

### 단점
- 텍스트 프롬프트가 필요한 태스크에만 적용 가능
- 우리 태스크는 키포인트 기반이므로 직접 적용 어려움

### 우리 태스크 적합성
❌ **직접 적용 어려움**: 우리는 텍스트 프롬프트가 아닌 키포인트를 사용
- 키포인트 → 텍스트 변환 후 사용 가능하지만 간접적

---

## 4. Pose Keypoint 반영 평가 방법

### 추천 방법

#### 방법 1: PCK (Percentage of Correct Keypoints)
- **원리**: 생성된 이미지에서 키포인트를 다시 추출하고, 입력 키포인트와 비교
- **계산**: 예측 키포인트가 정답 키포인트로부터 특정 거리(보통 머리 크기의 일정 비율) 내에 있으면 정확한 것으로 간주
- **공식**: `PCK@α = (올바른 키포인트 수) / (전체 키포인트 수)`
  - α는 임계값 (예: 0.1, 0.2 등)

#### 방법 2: PCKh (PCK with head size normalization)
- **원리**: PCK와 동일하지만, 머리 크기로 정규화하여 더 정확한 평가
- **적용**: 사람의 크기가 다른 경우에도 공정한 평가 가능

#### 방법 3: Keypoint Distance Error
- **원리**: 각 키포인트의 예측 위치와 정답 위치 간의 유클리드 거리 계산
- **평가 지표**:
  - Mean Per Joint Position Error (MPJPE)
  - Mean Per Joint Position Error (Normalized)

#### 방법 4: Pose Similarity Score
- **원리**: 키포인트 좌표를 벡터로 변환하여 코사인 유사도 계산
- **장점**: 포즈의 방향과 구조적 유사성을 측정

### 구현 방법

```python
# 1. 생성된 이미지에서 키포인트 추출 (OpenPose, MediaPipe 등 사용)
# 2. 입력 키포인트와 추출된 키포인트 비교
# 3. PCK/PCKh 또는 거리 기반 메트릭 계산
```

---

## 종합 추천

### 우리 태스크에 가장 적합한 메트릭 조합:

1. **LPIPS** ⭐⭐⭐⭐⭐
   - 원본-생성 이미지 간 전반적 시각적 유사성
   - 필수 메트릭

2. **CLIP Similarity** ⭐⭐⭐⭐
   - 의미적 유사성 보조 평가
   - 얼굴/옷 등 주요 요소 유지 확인

3. **PCK/PCKh** ⭐⭐⭐⭐⭐
   - 포즈 정확도 평가
   - 핵심 메트릭

4. **Keypoint Distance Error** ⭐⭐⭐⭐
   - 포즈 정확도의 정량적 측정
   - PCK와 함께 사용

### 구현 우선순위:
1. **PCK/PCKh** (포즈 평가 - 핵심)
2. **LPIPS** (전반적 유사성)
3. **CLIP Similarity** (의미적 유사성)
4. **Keypoint Distance Error** (상세 포즈 분석)

